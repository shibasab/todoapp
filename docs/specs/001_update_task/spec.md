Title: タスクの更新機能
Status: Ready
Created: 2026-01-14
Last updated: 2026-01-14
Source: ../000_backlog/update-task.md

## Goal
ユーザーが既存のタスクの内容（タイトル、説明）を変更できるようにする。これにより、入力ミスの修正や、情報の更新が可能になる。

## Non-goals
- タスクの削除機能（別機能として定義）
- 一括更新機能（将来の検討事項）
- 他ユーザーのタスク編集（現時点では認証ユーザー本人のタスクのみ想定）
- タスクのステータス管理（完了/未完了など。別機能として定義）

## User Scenarios & Testing
1. **タイトルの修正**
   - **Given**: ユーザーがタスク詳細画面または編集モードを開いている。
   - **When**: タスクのタイトルを変更し、「保存」ボタンを押す。
   - **Then**: タスクリストおよび詳細画面で、新しいタイトルが表示される。

2. **説明文の修正**
   - **Given**: 既存のタスクがある。
   - **When**: タスクの説明文を編集して保存する。
   - **Then**: 詳細画面で更新された説明文が表示される。

3. **バリデーションエラー**
   - **Given**: タスク編集画面を開いている。
   - **When**: 必須項目である「タイトル」を空にして保存しようとする。
   - **Then**: エラーメッセージが表示され、変更は保存されない。

## Edge Cases
- **存在しないタスクID**: 更新リクエスト時にタスクが存在しない場合（404エラー）。
- **タスク名が重複**: 更新リクエスト時に同じ名前のタスクが存在する場合（409エラー）。
- **通信エラー**: 保存中にネットワークが切断された場合。

## Requirements

### Functional Requirements
- **FR-001**: ユーザーは既存のタスクを選択し、編集モードに入ることができる (MUST)。
- **FR-002**: 以下のフィールドを更新可能とする (MUST):
    - タイトル (Title)
    - 説明 (Description)
- **FR-003**: 更新時には入力値のバリデーションを行う (MUST)。
    - タイトルは必須かつ空文字禁止。
- **FR-004**: 保存成功時、ユーザーに完了通知または更新後の画面を表示する (SHOULD)。
- **FR-005**: 保存失敗時、エラー理由をユーザーに提示する (MUST)。

### Non-functional Requirements
- **NFR-001**: 更新処理はユーザーがボタンを押してから1秒以内に完了（または応答）すること。

## Open Questions
### Issue#55: PUTの更新方式
- **決定**: 既存フロントエンドが`PUT`前提のため、互換性維持を優先し、`PUT /api/todos/{todo_id}/`は**部分更新（PATCH相当）**として扱う。未指定のフィールドは既存値を保持する。  
  - 背景: `backend/src/http/todo/routes.ts`の`@router.put("/{todo_id}/")`は現在全置換の説明だが、フロントエンド改修コストを抑えるため互換性を優先する。
- **代替案（不採用）**: HTTP仕様の厳密性を優先する場合は`PATCH`を新設し、`PUT`は全置換を維持する。ただしこの場合はフロントエンドの更新が必要となる。
